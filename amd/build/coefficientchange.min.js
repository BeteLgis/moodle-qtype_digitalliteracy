define(function(){var d=[];function h(e,t){this.id=e,this.placeHolder=0===t.length,this.value=this.placeHolder?0:parseInt(t)}function l(e,t,n){var l=e.value.toString().replace(/[^0-9]/g,"");0!==l.length?(100<(l=parseInt(l,10))&&(l=100),e.value=l,e.placeholder=""):e.value="";for(var a=0,r=[],u=0;u<d.length;u++){var o=d[u],v=document.getElementById(o);v.hidden||(r.push(o),a+=0===v.value.length?0:parseInt(v.value,10))}a<=100?function(e,t){var n,l=[];for(n=0;n<t.length;n++){var a=t[n],a=new h(a,document.getElementById(a).value);a.placeHolder&&l.push(a)}if(0===l.length)return;e=100-e;var r=Math.floor(e/l.length);for(n=0;n<l.length;n++)l[n].value=r,e-=r;if(1<l.length&&0!==e)for(var u=0;0!==e;e--)l[u].value++,u=u+1===l.length?0:u+1;for(n=0;n<l.length;n++){var o=l[n];document.getElementById(o.id).placeholder=o.value}}(a,r):function(e,t,n){var l,a,r=[];for(e-=100,a=0;a<n.length;a++){var u=n[a],o=new h(u,document.getElementById(u).value);0!==o.value&&u!==t&&r.push(o)}var v=Math.floor(e/r.length);for(a=0;a<r.length;a++)0<=(l=r[a]).value-v?(l.value-=v,e-=v):(e-=l.value,l.value=0);if(1<r.length&&0!==e)for(r.sort(function(e,t){return t.value-e.value});0!=e--;){var d=r.shift();d.value--;var i=0;for(a=0;a<r.length;a++)if(r[a]<=d.value){i=a;break}r.splice(i,0,d)}for(a=0;a<r.length;a++)l=r[a],document.getElementById(l.id).value=l.value}(a,t,r),n||function(){for(var e=0;e<d.length;e++)document.getElementById(d[e]).dispatchEvent(new CustomEvent("update"))}()}return h.prototype.toString=function(){return this.id+" : "+this.value},{process:function(e){if(document.getElementById("id_responseformat")){d=e;for(var n=0;n<d.length;n++)!function(){var e=d[n],t=document.getElementById(e);t.addEventListener("input",function(){l(t,e,!1)}),l(t,e,!0),t.addEventListener("dblclick",function(){0!==t.placeholder.length&&(t.value=t.placeholder),t.dispatchEvent(new CustomEvent("update"))})}()}}}});