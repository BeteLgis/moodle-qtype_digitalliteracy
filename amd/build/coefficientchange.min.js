define(function(){function a(a){if(document.getElementById("id_responseformat")){g=a;for(var b=0;b<g.length;b++)!function(){var a=g[b],d=document.getElementById(a);d.addEventListener("input",function(){c(d,a,!1)}),c(d,a,!0),d.addEventListener("dblclick",function(){0!==d.placeholder.length&&(d.value=d.placeholder),d.dispatchEvent(new CustomEvent("update"))})}()}}function b(a,b){this.id=a,this.placeHolder=0===b.length,this.value=this.placeHolder?0:parseInt(b)}function c(a,b,c){var h=a.value.toString().replace(/[^0-9]/g,"");if(0!==h.length){var i=parseInt(h,10);i>100&&(i=100),a.value=i,a.placeholder=""}else a.value="";for(var j=0,k=[],l=0;l<g.length;l++){var m=g[l],n=document.getElementById(m);n.hidden||(k.push(m),j+=0===n.value.length?0:parseInt(n.value,10))}j<=100?d(j,k):e(j,b,k),c||f()}function d(a,c){var d,e=[];for(d=0;d<c.length;d++){var f=c[d],g=new b(f,document.getElementById(f).value);g.placeHolder&&e.push(g)}if(0!==e.length){a=100-a;var h=Math.floor(a/e.length);for(d=0;d<e.length;d++)e[d].value=h,a-=h;if(e.length>1&&0!==a)for(var i=0;0!==a;a--)e[i].value++,i=i+1===e.length?0:i+1;for(d=0;d<e.length;d++){var j=e[d];document.getElementById(j.id).placeholder=j.value}}}function e(a,c,d){var e,f,g=[];for(a-=100,f=0;f<d.length;f++){var h=d[f],i=new b(h,document.getElementById(h).value);0!==i.value&&h!==c&&g.push(i)}var j=Math.floor(a/g.length);for(f=0;f<g.length;f++)e=g[f],e.value-j>=0?(e.value-=j,a-=j):(a-=e.value,e.value=0);if(g.length>1&&0!==a)for(g.sort(function(a,b){return b.value-a.value});0!==a--;){var k=g.shift();k.value--;var l=0;for(f=0;f<g.length;f++)if(g[f]<=k.value){l=f;break}g.splice(l,0,k)}for(f=0;f<g.length;f++)e=g[f],document.getElementById(e.id).value=e.value}function f(){for(var a=0;a<g.length;a++)document.getElementById(g[a]).dispatchEvent(new CustomEvent("update"))}var g=[];return b.prototype.toString=function(){return this.id+" : "+this.value},{process:a}});